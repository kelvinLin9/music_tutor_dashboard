import{_ as S,a as h,c as m,b as e,t as l,p as P,h as w,q as T,x as _,s as v,o as k,F as O,k as C,u as d,d as y}from"./index-qN_PaeON.js";import{P as M}from"./Pagination-b7hIT1ir.js";/* empty css                                                */import{h as u,f as B,g as D,i as $,j as A,S as x,k as I,u as E}from"./user-CMCZhkot.js";const L=t=>(P("data-v-670fcafe"),t=t(),w(),t),N={class:"modal fade",id:"orderDetailModal",tabindex:"-1","aria-labelledby":"orderDetailModalLabel","aria-hidden":"true","data-bs-backdrop":"static"},j={class:"modal-dialog modal-lg"},F={class:"modal-content"},G=L(()=>e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"orderDetailModalLabel"},"訂單詳細資料"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),V={class:"modal-body"},q={__name:"OrderDetailModal",props:{orderTemp:{type:Object}},emits:["update:orderTemp","update:photo"],setup(t,{emit:n}){return(a,r)=>(h(),m("div",N,[e("div",j,[e("div",F,[G,e("div",V,l(t.orderTemp),1)])])]))}},R=S(q,[["__scopeId","data-v-670fcafe"]]),U=T("orderStore",()=>{const t=_(!1),n=_([]),a=_({}),r=_({}),b=u(async()=>{t.value=!0;const s=await B();console.log(s),n.value=s.data.data,console.log("getOrders",n.value)},()=>t.value=!1),p=u(async s=>{t.value=!0;const o=await D(s);console.log(o),a.value=o.data,console.log("getOrder",a.value)},()=>t.value=!1),f=u(async()=>{t.value=!0;const s=await $(r.value);a.value=s.data,console.log("editOrder",a.value)},()=>t.value=!1),g=u(async()=>{t.value=!0;const s=await A(r.value);console.log(s)},()=>t.value=!1),c=u(async s=>{x.fire({title:"確定要刪除這個訂單嗎？",text:"你將無法撤銷此操作！",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"是的，刪除它！",cancelButtonText:"取消"}).then(o=>{o.isConfirmed&&(t.value=!0,I(s).then(i=>{console.log(i),x.fire("已刪除！","你的訂單已被刪除。","success")}).catch(i=>{console.error("刪除操作失敗：",i)}).finally(()=>{t.value=!1}))})},()=>t.value=!1);return{orderLoading:t,orders:n,order:a,orderTemp:r,getOrders:b,getOrder:p,editOrder:f,addOrder:g,deleteOrder:c}}),z={class:"card shadow border-0 mb-7"},H={class:"table-responsive"},J={class:"table table-hover table-nowrap"},K=e("thead",{class:"thead-light"},[e("tr",null,[e("th",{scope:"col"},"Purchase Time"),e("th",{scope:"col"},"Order Number"),e("th",{scope:"col"},"Email"),e("th",{scope:"col"},"Name"),e("th",{scope:"col"},"Amount"),e("th",{scope:"col"},"Payment Status"),e("th",{scope:"col"},"Payment Method"),e("th",{scope:"col"},"Actions")])],-1),Q=["disabled","onClick"],W=e("i",{class:"bi bi-book text-white"},null,-1),X=[W],Y=["disabled","onClick"],Z=e("i",{class:"bi bi-trash text-white"},null,-1),ee=[Z],te={class:"card-footer bcoupon-0 d-flex justify-content-center"},le={__name:"Order",setup(t){const n=E(),{userInfo:a}=v(n),r=U(),{orders:b,orderTemp:p}=v(r),f=r.getOrders,g=r.deleteOrder;return k(()=>{f()}),(c,s)=>(h(),m(O,null,[e("div",z,[e("div",H,[e("table",J,[K,e("tbody",null,[(h(!0),m(O,null,C(d(b),o=>(h(),m("tr",{key:o},[e("td",null,l(o.createdAt.split("T")[0]),1),e("td",null,l(o._id),1),e("td",null,l(o.user.email),1),e("td",null,l(o.user.name),1),e("td",null,l(o.totalAmount),1),e("td",null,l(o.paymentStatus),1),e("td",null,l(o.paymentMethod),1),e("td",null,[e("button",{class:"btn btn-primary me-2","data-bs-toggle":"modal","data-bs-target":"#orderDetailModal",disabled:d(a).role!=="superuser"&&d(a).role!=="admin",onClick:i=>p.value=o.items},X,8,Q),e("button",{class:"btn btn-primary",disabled:d(a).role!=="superuser"&&d(a).role!=="admin",onClick:i=>d(g)(o._id)},ee,8,Y)])]))),128))])])]),e("div",te,[y(M,{totalPages:c.totalPages,initialPage:c.page,onPageChanged:c.updatePage},null,8,["totalPages","initialPage","onPageChanged"])])]),y(R,{orderTemp:d(p)},null,8,["orderTemp"])],64))}};export{le as default};
